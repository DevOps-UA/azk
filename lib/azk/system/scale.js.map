{"version":3,"file":"scale.js","sources":["../../../src/system/scale.js","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/12","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/14","@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"AAAA;ACAI,CAAJ,EAAI,CAAA,YAAY,qBAAoB,CAAC;UCArC,CAAA,OAAO,CFAkB,KAAK,CEAJ;;;uBAA1B,CAAA,OAAO,CFC2B,kBAAkB,CED1B;GFEnB,OAAM,EEFb,CAAA,OAAO,CFEY,YAAY,CEFL;AFItB,CAAJ,EAAI,CAAA,KAAK,EAAG;CAEV,MAAK,CAAL,UAAM,MAAM,CAAE,CAAA,SAAS,AAAc;OAAZ,QAAO,6CAAG,GAAE;AAEnC,CAAA,UAAO,EAAG,CAAA,CAAC,SAAS,CAAC,OAAO,CAAE,GAC7B,CAAC,CAAA;CAEF,SAAO,CAAA,KAAK,CAAC,IAAI,WAAa;CGXlC,WAAO,CCAP,eAAe,cDAS,ACAK,CCA7B,SAAS,IAAI,CAAE;CACT,cAAO,IAAI;;;;CCDjB,mBNYY,CAAA,IAAI,aAAa,CAAC,MAAM,CAAC,CMZb;;ACAxB,CAAA,iBAAI,WAAW,EAAE,CAAA;;;;ACAjB,CAAA,iBAAI,YAAY,ERaH,KQbuB,ARanB,CQbmB;;;;CCApC,mBAAO,CAAA,IAAI,IAAI,EAAE,CAAA;;CJCmB,MAC/B,CFAO,KAAI,CAAC,CAAC;MHYZ,CAAC;GACJ;CAED,aAAY,CAAZ,UAAa,MAAM;AACb,CAAJ,MAAI,CAAA,OAAO,EAAG,CAAA,MAAM,iBAAiB,CAAC;CACtC,SAAO,CAAA,KAAK,CAAC,IAAI,WAAa;;;;CGnBlC,WAAO,CCAP,eAAe,cDAS,ACAK,CCA7B,SAAS,IAAI,CAAE;CACT,cAAO,IAAI;;;iBLoBE,EAAC;;;;AUrBpB,CAAA,iBAAI,MAAM,EAAG,CAAA,CVqBS,CAAC,EAAG,CAAA,OAAO,OAAO,CUrBR,QAAwC,CAAC;CACjE,mBAAK;;AVoB6B,CAAA,cAAC,EAAE;;;;AACrC,CAAA,mBAAM,EAAM,CAAA,OAAO,CAAC,CAAC,CAAC,CAAC;;;;;CMtB/B,mBNuB0B,CAAA,IAAI,UAAU,CAAC,MAAM,CAAC,CMvBxB;;ANuBhB,CAAA,sBAAS,EWvBjB,CAAA,IAAI,KAAK,AXuBuC,CAAA;;;;CACxC,iBAAI,SAAS,CAAE;CACb,oBAAM,IAAI,kBAAiB,CAAC,MAAM,KAAK,CAAE,CAAA,MAAM,KAAK,CAAC,CAAC;eACvD;CAAA;;;AQ1BT,CAAA,iBAAI,YAAY,ER6BH,KQ7BuB,AR6BnB,CQ7BmB;;;;CCApC,mBAAO,CAAA,IAAI,IAAI,EAAE,CAAA;;CJCmB,MAC/B,CFAO,KAAI,CAAC,CAAC;MH4BZ,CAAC;GACJ;CAED,UAAS,CAAT,UAAU,MAAM,AAAsB;OAApB,aAAY,6CAAG,MAAK;CACpC,OAAI,YAAY;AAAE,CAAA,iBAAY,EAAG,EAAE,GAAG,CAAE,KAAI,CAAE,CAAC;AAC/C,CAD+C,SACxC,CAAA,MAAM,eAAe,CAAC,YAAY,CAAC,KAAK,WAAE,UAAU,CAAK;CAC9D,WAAO,CAAA,MAAM,OAAO,CAAC,UAAU,CAAC,CAAC;KAClC,EAAC,CAAC;GACJ;CACF,CAAA;;AYvCD,CAAA,KAAM,QAAQ;CCAd,YAAwB;CAAE,gBAAyB;GAAE;ACArD,CAAA,WAAU,CAAE,KAAI;CAAA,AFAkB,CAAC;CZ0CnC","sourcesContent":["import { async, _ } from 'azk';\nimport { SystemDependError } from 'azk/utils/errors';\nimport docker from 'azk/docker';\n\nvar Scale = {\n\n  scale(system, instances, options = {}) {\n    // Default options\n    options = _.defaults(options, {\n    })\n\n    return async(this, function* () {\n      yield this.checkDepends(system);\n      return true;\n    });\n  },\n\n  checkDepends(system) {\n    var depends = system.dependsInstances;\n    return async(this, function* () {\n      var instances, depend;\n      for (var d = 0; d < depends.length; d++) {\n        depend    = depends[d];\n        instances = yield this.instances(depend);\n        if (instances) {\n          throw new SystemDependError(system.name, depend.name);\n        }\n      }\n\n      return true;\n    });\n  },\n\n  instances(system, include_dead = false) {\n    if (include_dead) include_dead = { all: true };\n    return docker.listContainers(include_dead).then((containers) => {\n      return system.filter(containers);\n    });\n  },\n}\n\nexport { Scale };\n","var __moduleName = $__placeholder__0;","require($__placeholder__0)","return $__placeholder__0(\n            $__placeholder__1,\n            this);","$traceurRuntime.generatorWrap","function($ctx) {\n      while (true) $__placeholder__0\n    }","return $__placeholder__0","$ctx.maybeThrow()","$ctx.returnValue = $__placeholder__0","return $ctx.end()","$ctx.state = ($__placeholder__0) ? $__placeholder__1 : $__placeholder__2;\n        break","$ctx.sent","module.exports = $__placeholder__0;","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true"]}