{"version":3,"file":"run.js","sources":["../../../src/system/run.js","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/12","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"AAAA;ACAI,CAAJ,EAAI,CAAA,YAAY,mBAAoB,CAAC;UCArC,CAAA,OAAO,CFAkB,KAAK,CEAJ;;;GFCnB,OAAM,EEDb,CAAA,OAAO,CFCY,YAAY,CEDL;uBAA1B,CAAA,OAAO,CFE2B,kBAAkB,CEF1B;AFItB,CAAJ,EAAI,CAAA,GAAG,EAAG;CACR,SAAQ,CAAR,UAAS,MAAM,CAAE,CAAA,OAAO,AAAc;OAAZ,QAAO,6CAAG,GAAE;CACpC,SAAO,CAAA,IAAI,WAAW,CAAC,MAAM,CAAE,QAAO,CAAC,KAAK,WAAE,KAAK,CAAK;AACtD,CAAA,YAAO,EAAG,CAAA,MAAM,aAAa,CAAC,OAAO,CAAC,CAAC;CACvC,WAAO,CAAA,MAAM,IAAI,CAAC,MAAM,MAAM,KAAK,CAAE,QAAO,CAAE,QAAO,CAAC,CAAC;KACxD,EAAC,CAAC;GACJ;CAED,UAAS,CAAT,UAAU,MAAM,AAAc;OAAZ,QAAO,6CAAG,GAAE;CAC5B,SAAO,CAAA,IAAI,WAAW,CAAC,MAAM,CAAE,QAAO,CAAC,KAAK,WAAE,KAAK,CAAK;AACtD,CAAA,YAAO,WAAW,EAAG,MAAK,CAAC;AAC3B,CAAA,YAAO,EAAG,CAAA,MAAM,cAAc,CAAC,OAAO,CAAC,CAAC;AACpC,CAAJ,QAAI,CAAA,OAAO,EAAG,CAAA,OAAO,QAAQ,CAAC;CAC9B,WAAO,CAAA,MAAM,IAAI,CAAC,MAAM,MAAM,KAAK,CAAE,QAAO,CAAE,QAAO,CAAC,CAAC;KACxD,EAAC,CAAC;GACJ;CAGD,WAAU,CAAV,UAAW,MAAM,CAAE,CAAA,OAAO;AACxB,CAAA,UAAO,EAAG,CAAA,CAAC,SAAS,CAAC,OAAO,CAAE,EAC5B,UAAU,CAAE,KAAI,CACjB,CAAC,CAAC;CAEH,SAAO,CAAA,KAAK,UAAY;;;CG3B5B,WAAO,CCAP,eAAe,cDAS,ACAK,CCA7B,SAAS,IAAI,CAAE;CACT,cAAO,IAAI;;;CL2BX,iBAAI,OAAO,WAAW,CAAE;yBACR,CAAA,MAAM,MAAM,KAAK,EAAE;eAClC,KAAM;yBACS,CAAA,MAAM,MAAM,MAAM,EAAE,KAAK,WAAE,KAAK,CAAK;CACjD,qBAAI,KAAK,GAAI,KAAI,CAAE;CACjB,wBAAM,IAAI,kBAAiB,CAAC,MAAM,KAAK,CAAE,CAAA,MAAM,MAAM,KAAK,CAAC,CAAC;mBAC7D;AACD,CADC,uBACM,MAAK,CAAC;iBACd,EAAC;eACH;CAAA;;;;CMrCP,mBNuCwB,CAAA,OAAO,SAAS,WAAE,KAAK,CAAK;AAC5C,CAAA,oBAAK,OAAO,EAAG,OAAM,CAAC;CACtB,qBAAO,MAAK,CAAC;eACd,EAAC,CM1CgB;;qBCAxB,CAAA,IAAI,KAAK;;;;ACAT,CAAA,iBAAI,YAAY,ER4CH,CAAA,KAAK,QAAQ,EQ5CU,AR4CR,CQ5CQ;;;;CCApC,mBAAO,CAAA,IAAI,IAAI,EAAE,CAAA;;CJCmB,MAC/B,CFAO,KAAI,CAAC,CAAC;MH2CZ,CAAC;GACJ;CACF,CAAA;;AU/CD,CAAA,KAAM,QAAQ;CCAd,UAAwB;CAAE,cAAyB;GAAE;ACArD,CAAA,WAAU,CAAE,KAAI;CAAA,AFAkB,CAAC;CVkDnC","sourcesContent":["import { _, async } from 'azk';\nimport docker from 'azk/docker';\nimport { ImageNotAvailable } from 'azk/utils/errors';\n\nvar Run = {\n  runShell(system, command, options = {}) {\n    return this.checkImage(system, options).then((image) => {\n      options = system.shellOptions(options);\n      return docker.run(system.image.name, command, options);\n    });\n  },\n\n  runDaemon(system, options = {}) {\n    return this.checkImage(system, options).then((image) => {\n      options.image_data = image;\n      options = system.daemonOptions(options);\n      var command = options.command;\n      return docker.run(system.image.name, command, options);\n    });\n  },\n\n  // Check and pull image\n  checkImage(system, options) {\n    options = _.defaults(options, {\n      image_pull: true,\n    });\n\n    return async(function* () {\n      if (options.image_pull) {\n        var promise = system.image.pull();\n      } else {\n        var promise = system.image.check().then((image) => {\n          if (image == null) {\n            throw new ImageNotAvailable(system.name, system.image.name);\n          }\n          return image;\n        });\n      }\n\n      var image = yield promise.progress((event) => {\n        event.system = system;\n        return event;\n      });\n\n      return image.inspect();\n    });\n  },\n}\n\nexport { Run }\n","var __moduleName = $__placeholder__0;","require($__placeholder__0)","return $__placeholder__0(\n            $__placeholder__1,\n            this);","$traceurRuntime.generatorWrap","function($ctx) {\n      while (true) $__placeholder__0\n    }","return $__placeholder__0","$ctx.sent","$ctx.returnValue = $__placeholder__0","return $ctx.end()","module.exports = $__placeholder__0;","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true"]}