{"version":3,"file":"start.js","sources":["../../../src/cmds/start.js","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","src/cmds/start.js","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/20","@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/19","@traceur/generated/TemplateParser/15","@traceur/generated/TemplateParser/12","@traceur/generated/TemplateParser/16","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/14","@traceur/generated/TemplateParser/17","@traceur/generated/TemplateParser/18","@traceur/generated/TemplateParser/21","@traceur/generated/TemplateParser/3","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/5"],"names":[],"mappings":"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","sourcesContent":["module.exports = function() {\n            $__placeholder__0\n          }.call($__placeholder__1);","var __moduleName = $__placeholder__0;","require($__placeholder__0)","import { log, _, async, config, t, dynamic } from 'azk';\nimport { Command, Helpers } from 'azk/cli/command';\nimport { SYSTEMS_CODE_ERROR, NotBeenImplementedError } from 'azk/utils/errors';\nimport { Cmd as ScaleCmd } from 'azk/cmds/scale';\n\ndynamic(this, {\n  Manifest() {\n    return require('azk/manifest').Manifest;\n  },\n});\n\nclass Cmd extends ScaleCmd {\n  _scale(systems, action, opts) {\n    var options = {\n      start: { instances: {}, key: \"already\" },\n      stop:  { instances: 0 , key: \"not_running\" },\n    };\n    options = options[action];\n\n    return async(this, function* () {\n      var system, result = 0;\n      systems = _.clone(systems);\n\n      while(system = systems.shift()) {\n        var ns = [\"commands\", action];\n\n        this.verbose([...ns, \"verbose\"], system);\n        var icc = yield super(system, _.clone(options.instances), opts);\n\n        if (icc == 0) {\n          this.fail([...ns, options.key], system);\n          result = SYSTEMS_CODE_ERROR;\n        }\n      };\n\n      return result;\n    });\n  }\n\n  start(manifest, systems, opts) {\n    return this._scale(systems, 'start', opts);\n  }\n\n  stop(manifest, systems, opts) {\n    systems = systems.reverse();\n    return this._scale(systems, 'stop', opts);\n  }\n\n  reload(manifest, systems, opts) {\n    this.fail('commands.reload.deprecation');\n    return this.restart(manifest, systems, opts);\n  }\n\n  restart(manifest, systems, opts) {\n    return async(this, function* () {\n      yield this.stop(manifest, systems, opts);\n      yield this.start(manifest, systems, opts);\n    });\n  }\n}\n\nexport function init(cli) {\n  var cmds = [\n    (new Cmd('start [system]' , cli))\n      .addOption(['--reprovision', '-R'], { default: false }),\n    (new Cmd('stop [system]'  , cli))\n      .addOption(['--remove', '-r'], { default: true }),\n    (new Cmd('restart [system]', cli))\n      .addOption(['--reprovision', '-R'], { default: false }),\n    (new Cmd('reload [system]', cli))\n      .addOption(['--reprovision', '-R'], { default: true }),\n  ];\n}\n","var $__placeholder__0 = $__placeholder__1","$traceurRuntime.defaultSuperCall(this,\n                $__placeholder__0.prototype, arguments)","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2,\n                                       $__placeholder__3)","return $__placeholder__0(\n            $__placeholder__1,\n            this);","$traceurRuntime.generatorWrap","function($ctx) {\n      while (true) $__placeholder__0\n    }","$ctx.state = ($__placeholder__0) ? $__placeholder__1 : $__placeholder__2;\n        break","$traceurRuntime.spread($__placeholder__0)","return $__placeholder__0","$traceurRuntime.superCall($__placeholder__0, $__placeholder__1, $__placeholder__2,\n                                   $__placeholder__3)","$ctx.sent","$ctx.returnValue = $__placeholder__0","return $ctx.end()","$ctx.maybeThrow()","return $__placeholder__0","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true","typeof global !== 'undefined' ? global : this"]}