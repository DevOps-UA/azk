{"version":3,"file":"start.js","sources":["../../../src/cmds/start.js","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/18","@traceur/generated/TemplateParser/12","@traceur/generated/TemplateParser/17","@traceur/generated/TemplateParser/14","@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/15","@traceur/generated/TemplateParser/16","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/19","@traceur/generated/TemplateParser/20","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"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","sourcesContent":["import { log, _, async, config, t } from 'azk';\nimport { Command, Helpers } from 'azk/cli/command';\nimport { Manifest } from 'azk/manifest';\nimport { SYSTEMS_CODE_ERROR, NotBeenImplementedError } from 'azk/utils/errors';\n\nclass Cmd extends Command {\n  action(opts) {\n    return async(this, function* () {\n      yield Helpers.requireAgent();\n\n      var manifest = new Manifest(this.cwd, true);\n      var systems  = Helpers.getSystemsByName(manifest, opts.system);\n\n      yield this[`${this.name}`](manifest, systems, opts);\n\n      if (_.contains([\"start\", \"stop\", \"scale\"], this.name)) {\n        this.output(\"\");\n        yield this.status(manifest, systems);\n      }\n    });\n  }\n\n  _scale(system, instances = {}) {\n    var progress = (event) => {\n      var pull_progress = Helpers.newPullProgress(this);\n      if (event.type == \"pull_msg\") {\n        pull_progress(event);\n      } else {\n        var keys = [\"commands\", \"scale\"];\n        switch(event.type) {\n          case \"action\":\n            var data = { image: system.image.name };\n            this.tOutput([...keys, event.action], data);\n            break;\n          case \"scale\":\n            //keys.push((event.from > event.to) ? \"starting\" : \"stopping\");\n            this.tOutput([...keys, \"scale\"], event);\n            //console.log([...keys, \"scale\"], event);\n            break;\n          case \"provision\":\n            this.tOutput([...keys, \"provision\"], event);\n            break;\n          default:\n            log.debug(event);\n        }\n      }\n    }\n\n    return system.scale(instances).progress(progress);\n  }\n\n  start(manifest, systems) {\n    return async(this, function* () {\n      for (var i = 0; i < systems.length; i++) {\n        var system = systems[i];\n        var icc = yield this._scale(system);\n        if (icc == 0) {\n          this.fail('commands.start.already', system);\n          return SYSTEMS_CODE_ERROR;\n        }\n        return 0;\n      }\n    });\n  }\n\n  scale(manifest, systems, opts) {\n    return async(this, function* () {\n      for (var i = 0; i < systems.length; i++) {\n        var system = systems[i];\n        yield this._scale(system, opts.instances);\n      }\n    })\n  }\n\n  stop(manifest, systems, opts) {\n    return async(this, function* () {\n      for (var i = 0; i < systems.length; i++) {\n        var system = systems[i];\n        var icc    = yield this._scale(system, 0);\n        if (icc == 0) {\n          this.fail('commands.stop.not_running', system);\n          return SYSTEMS_CODE_ERROR;\n        }\n        return 0;\n      }\n    });\n  }\n\n  status(manifest, systems, opts = {}) {\n    var columns = ['System'.blue, 'Instances'.yellow, 'Hostname'.green, 'Ports'.magenta];\n    var table_status = this.table_add('table_status', { head: columns });\n\n    // Instances columns\n    columns = ['Up Time'.green, 'Command'.cyan];\n    if (opts.all) {\n      columns.unshift('Status'.red);\n      columns.unshift('Type'.magenta);\n    };\n    columns.unshift('Azk id'.blue);\n\n    return async(this, function* () {\n      for (var system of systems) {\n        var instances = yield system.instances({ include_dead: opts.all });\n\n        if (opts.instances) {\n          instances = _.sortBy(instances, function(container) {\n            return container.Created * -1;\n          });\n\n          var rows = _.map(instances, function(container) {\n            var names = container.Names[0].split('.');\n            var row   = [ container.Status, container.Command ];\n\n            if (opts.all) {\n              // Status\n              if (container.State.Running) {\n                var status = container.State.Paused ? 'paused'.blue : 'runnig'.green;\n              } else {\n                var status =  container.State.ExitCode > 0 ? \"dead\".red : \"ended\".cyan;\n              }\n\n              // Type\n              var type = container.Annotations.azk.type;\n              if (type == \"shell\") {\n                type = `${type}: ${container.Annotations.azk.shell.white}`;\n              }\n\n              // Add rows\n              row.unshift(status);\n              row.unshift(type.magenta);\n            }\n\n            row.unshift(container.Id.slice(0, 12));\n\n            return row;\n          });\n\n          this.output(system.name + \": \" + instances.length + \" instances\");\n          var table_name = 'table_' + system.name;\n          this.table_add(table_name, { head: columns });\n          this.table_push(table_name, ...rows);\n          this.table_show(table_name);\n        } else {\n          if (system.balanceable && instances.length > 0) {\n            var hostname = system.url;\n          } else {\n            var hostname = system.hostname;\n          }\n          var ports = yield this._ports_map(system, instances);\n          var line  = [system.name, instances.length, hostname, ports.join(', ')];\n          this.table_push(table_status, line);\n        }\n      }\n\n      if (!opts.instances)\n        this.table_show(table_status);\n    });\n  }\n\n  _ports_map(system, instances) {\n    return async(this, function* () {\n      var instance, ports = [];\n\n      instances = _.clone(instances);\n      while(instance = instances.pop()) {\n        _.each(instance.NetworkSettings.Access, (port) => {\n          var name = system.portName(port.name);\n          ports.push(`${name}:${port.port || \"n/m\".red}`);\n        });\n      }\n\n      return _.isEmpty(ports) ? [\"-\"] : ports;\n    });\n  }\n\n  reload(manifest, systems, opts) {\n    throw new NotBeenImplementedError('reload');\n  }\n\n  up(manifest, systems, opts) {\n    throw new NotBeenImplementedError('up');\n  }\n}\n\nexport function init(cli) {\n  (new Cmd('start [system]', cli));\n\n  // TODO: Add kill\n  (new Cmd('stop [system]', cli));\n\n  (new Cmd('scale [system]', cli))\n    .addOption(['--instances', '-i'], { type: Number, default: 1 });\n\n  (new Cmd('status [system]', cli))\n    .addOption(['--instances', '-i'], { default: false })\n    .addOption(['--all', '-a'], { default: false });\n\n  (new Cmd('reload [system]', cli));\n}\n","var __moduleName = $__placeholder__0;","require($__placeholder__0)","var $__placeholder__0 = $__placeholder__1","$traceurRuntime.defaultSuperCall(this,\n                $__placeholder__0.prototype, arguments)","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2,\n                                       $__placeholder__3)","return $__placeholder__0(\n            $__placeholder__1,\n            this);","$traceurRuntime.generatorWrap","function($ctx) {\n      while (true) $__placeholder__0\n    }","return $__placeholder__0","$ctx.maybeThrow()","$ctx.state = ($__placeholder__0) ? $__placeholder__1 : $__placeholder__2;\n        break","return $ctx.end()","$traceurRuntime.spread($__placeholder__0)","$ctx.sent","$ctx.returnValue = $__placeholder__0","\n        for (var $__placeholder__0 =\n                 $__placeholder__1[Symbol.iterator](),\n                 $__placeholder__2;\n             !($__placeholder__3 = $__placeholder__4.next()).done; ) {\n          $__placeholder__5;\n          $__placeholder__6;\n        }","module.exports = $__placeholder__0;","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true"]}