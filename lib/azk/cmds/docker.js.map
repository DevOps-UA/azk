{"version":3,"file":"docker.js","sources":["../../../src/cmds/docker.js","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","src/cmds/docker.js","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/18","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/17","@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/14","@traceur/generated/TemplateParser/12","@traceur/generated/TemplateParser/15","@traceur/generated/TemplateParser/16","@traceur/generated/TemplateParser/19","@traceur/generated/TemplateParser/3","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/5"],"names":[],"mappings":"AAAA,MAAM,QAAQ,EAAG,CAAA,SAAS;;ACAtB,CAAJ,IAAI,CAAA,YAAY,oBAAoB,CAAC;YCArC,CAAA,OAAO,CCA+C,KAAK,CDAjC;;;;;;;YAA1B,CAAA,OAAO,CCC0B,iBAAiB,CDDxB;;;ACG1B,CAAA,QAAO,CAAC,IAAI,CAAE,EACZ,QAAQ,CAAR,UAAS,CAAE;CACT,WAAO,CAAA,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC;KACzC,CACF,CAAC,CAAC;ACPC,CAAJ,IAAI,MDSJ,SAAM,IAAG;AETT,CAAA,kBAAe,iBAAiB,CAAC,IAAI,CACrB,eAA2B,CAAE,UAAS,CAAC,CAAA;GDDd,ADwCxC,CCxCwC;AEArC,CAAJ,IAAI,WAAqC,CAAA;ACAzC,CAAA,EAAC,eAAe,YAAY,CAAC;CJU3B,aAAU,CAAV,UAAW,IAAI;CACb,WAAO,CAAA,KAAK,CAAC,IAAI,WAAa;;;;;CKXlC,aAAO,CCAP,eAAe,cAAc,ADAL,CEAxB,SAAS,IAAI,CAAE;CACT,gBAAO,IAAI;;;sBPWA,CAAA,CAAC,IAAI,CAAC,OAAO,KAAK,MAAM,CAAC,CAAC,CAAC,YAAG,GAAG,CAAK;CAC/C,uBAAO,CAAA,GAAG,MAAM,CAAC,SAAS,CAAC,CAAA,GAAG,MAAM,EAAA,IAAG,EAAA,OAAK,GAAG,IAAG,CAAC;iBACpD,EAAC;;;;AQdR,CAAA,mBAAI,MAAM,EAAG,CAAA,CRgBH,CAAC,MAAM,CAAC,mBAAmB,CAAC,CQhBN,QAAwC,CAAC;CACjE,qBAAK;;uBRgBO,sBAAsB,EAAA,CAAA,IAAI,KAAK,CAAC,GAAG,CAAC,CAAA,CAAA,KAAG;;;;;CSjB3D,qBToBc,CAAA,OAAO,aAAa,CAAC,IAAI,CAAC,CSpBhB;;ACAxB,CAAA,mBAAI,WAAW,EAAE,CAAA;;;;uBVsBG,CAAA,MAAM,CAAC,sBAAsB,CAAC,CAAA,CAAG,OAAM;uBACvC,CAAA,KAAK,OAAO,YAAY,CAAC,IAAI,IAAI,CAAE,MAAK,CAAC;uBACzC,qBAAqB,EAAA,MAAK,EAAA,YAAY,EAAA,CAAA,IAAI,KAAK,CAAC,GAAG,CAAC,CAAA,CAAA,iBAAe;;;;AAGjF,CAAA,kBAAG,MAAM,CAAC,oBAAoB,CAAE,IAAG,CAAC,CAAC;;;;AW3B3C,CAAA,mBAAI,YAAY,EX4BH,CAAA,IAAI,OAAO,CAAC,GAAG,CW5BQ,AX4BP,CW5BO;;;;CCApC,qBAAO,CAAA,IAAI,IAAI,EAAE,CAAA;;CLCmB,QAC/B,CFAO,KAAI,CAAC,CAAC;QL2BZ,CAAC;KACJ;CAED,SAAM,CAAN,UAAO,IAAI;CACT,WAAO,CAAA,KAAK,CAAC,IAAI,WAAa;;;;CKjClC,aAAO,CCAP,eAAe,cAAc,ADAL,CEAxB,SAAS,IAAI,CAAE;CACT,gBAAO,IAAI;;;ACDjB,CAAA,mBAAI,MAAM,EAAG,CAAA,CRkCH,MAAM,CAAC,mBAAmB,CAAC,CQlCL,QAAwC,CAAC;CACjE,qBAAK;;;CCDb,qBTmCc,CAAA,OAAO,aAAa,EAAE,CSnCZ;;ACAxB,CAAA,mBAAI,WAAW,EAAE,CAAA;;;;sBVqCE,CAAA,IAAI,WAAW;sBAAf,UAAe,CAAf,IAAI,CAAY,KAAI,CAAC;;;;;CSrCxC,2BAAwB;;sBIAxB,CAAA,IAAI,KAAK;;;;AFAT,CAAA,mBAAI,YAAY,OAAoB,CAAA;;;;CCApC,qBAAO,CAAA,IAAI,IAAI,EAAE,CAAA;;CLCmB,QAC/B,CFAO,KAAI,CAAC,CAAC;QLoCZ,CAAC;KACJ;QA9Be,QAAO,CIRgC;CJyClD,SAAS,KAAI,CAAC,GAAG,CAAE;CACxB,SAAO,EAAC,GAAI,IAAG,CAAC,sBAAsB,CAAE,IAAG,CAAC,CAAC,CAAA;GAC9C;Ac5CD,Cd4CC;Ce5CD,aAAwB;CAAE,iBAAyB;KAAE;ACArD,CAAA,aAAU,CAAE,KAAI;CAAA,GFAQ;CjBEb,KAAK,CoBFhB,MAAO,OAAM,CAAA,GAAK,YAAW,CAAA,CAAG,OAAM,EAAG,KAAI,CpBEV,CAAC;CG4CpC","sourcesContent":["module.exports = function() {\n            $__placeholder__0\n          }.call($__placeholder__1);","var __moduleName = $__placeholder__0;","require($__placeholder__0)","import { _, async, log, config, utils, dynamic } from 'azk';\nimport { Command, Helpers } from 'azk/cli/command';\n\ndynamic(this, {\n  Manifest() {\n    return require('azk/manifest').Manifest;\n  },\n});\n\nclass Cmd extends Command {\n  run_docker(opts) {\n    return async(this, function* () {\n      var args = _.map(process.argv.slice(3), (arg) => {\n        return arg.match(/^.* .*$/) ? `\\\\\"${arg}\\\\\"` : arg;\n      });\n\n      if (!config('agent:requires_vm')) {\n        var cmd   = `/bin/sh -c \"docker ${args.join(\" \")}\"`;\n      } else {\n        // Require agent is started\n        yield Helpers.requireAgent(this);\n\n        var point = config('agent:vm:mount_point') + '.nfs';\n        var _path = utils.docker.resolvePath(this.cwd, point);\n        var cmd   = `azk vm ssh -t \"cd ${_path}; docker ${args.join(\" \")}\" 2>/dev/null`;\n      }\n\n      log.debug(\"docker options: %s\", cmd);\n      return this.execSh(cmd);\n    });\n  }\n\n  action(opts) {\n    return async(this, function* () {\n      if (config('agent:requires_vm')) {\n        yield Helpers.requireAgent();\n      }\n      return yield this.run_docker(opts);\n    });\n  }\n}\n\nexport function init(cli) {\n  return (new Cmd('docker [*dockerargs]', cli))\n}\n\n","var $__placeholder__0 = $__placeholder__1","$traceurRuntime.defaultSuperCall(this,\n                $__placeholder__0.prototype, arguments)","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2,\n                                       $__placeholder__3)","return $__placeholder__0(\n            $__placeholder__1,\n            this);","$traceurRuntime.generatorWrap","function($ctx) {\n      while (true) $__placeholder__0\n    }","$ctx.state = ($__placeholder__0) ? $__placeholder__1 : $__placeholder__2;\n        break","return $__placeholder__0","$ctx.maybeThrow()","$ctx.returnValue = $__placeholder__0","return $ctx.end()","$ctx.sent","return $__placeholder__0","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true","typeof global !== 'undefined' ? global : this"]}