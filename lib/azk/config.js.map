{"version":3,"file":"config.js","sources":["../../src/config.js","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"AAAA;ACAI,CAAJ,EAAI,CAAA,YAAY,eAAoB,CAAC;OCArC,CAAA,OAAO,CFAW,WAAW,CEAH;AFCtB,CAAJ,EAAI,CAAA,IAAI,EAAM,CAAA,OAAO,CAAC,MAAM,CAAC,CAAC;AAC1B,CAAJ,EAAI,CAAA,OAAO,EAAG,CAAA,OAAO,CAAC,UAAU,CAAC,CAAC;AAG9B,CAAJ,EAAI,CAAA,QAAQ,EACV,CAAA,OAAO,IAAI,cAAc,GACzB,CAAA,IAAI,KAAK,CAAC,IAAI,CAAE,KAAI,CAAC,CAAC;AAEpB,CAAJ,EAAI,CAAA,SAAS,EACX,CAAA,OAAO,IAAI,cAAc,GACzB,CAAA,IAAI,KAAK,CAAC,OAAO,IAAI,KAAK,CAAE,OAAM,CAAE,OAAM,CAAC,CAAC;AAG1C,CAAJ,EAAI,CAAA,WAAW,EAAG,EAAC,OAAO,IAAI,WAAW,GAAI,OAAM,CAAC,CAAC;AAIjD,CAAJ,EAAI,CAAA,OAAO,EAAG,CAAA,OAAO,IAAI,kBAAkB,GAAI,YAAW,CAAC;AACvD,CAAJ,EAAI,CAAA,KAAK,EAAK,CAAA,OAAO,IAAI,gBAAgB,GAAI,CAAA,OAAO,QAAQ,CAAC,OAAO,CAAC,CAAC;AAGlE,CAAJ,EAAI,CAAA,QAAQ,EAAG;AACX,CAAA,GAAE,CAAE,CAAA,OAAO,IAAI,gBAAgB,GAAM,MAAK;AAC5C,CAAA,KAAI,CAAE,CAAA,OAAO,IAAI,kBAAkB;AACnC,CAAA,KAAI,CAAE,CAAA,OAAO,IAAI,kBAAkB,GAAI,GAAE;AACzC,CAAA,SAAQ,CAAE,CAAA,gBAAgB,EAAG,CAAA,OAAO,IAAI,kBAAkB;CAAA,AAC3D,CAAC;AAGE,CAAJ,EAAI,CAAA,WAAW,EACb,CAAA,OAAO,IAAI,gBAAgB,GAC3B,EAAC,WAAW,EAAG,CAAA,SAAS,EAAG,MAAK,CAAA,CAAG,QAAO,CAAA,CAAG,8BAA6B,CAAC,CAAC;AAG1E,CAAJ,EAAI,CAAA,SAAS,EAAG,CAAA,OAAO,IAAI,UAAU,EAAG,QAAO,EAAG,OAAM,CAAC;CAEzD,OAAS,MAAK,CAAC,OAAO;AACpB,CAAA,EAAC,KAAK,CAAC,OAAO,YAAG,MAAM,CAAE,CAAA,GAAG,CAAK;CAC/B,OAAI,GAAG,GAAI,IAAG;AACZ,CAAA,YAAO,CAAC,GAAG,CAAC,EAAG,CAAA,CAAC,MAAM,CAAC,EAAE,CAAE,CAAA,OAAO,CAAC,GAAG,CAAC,CAAE,OAAM,CAAC,CAAC;CAAA,EACpD,EAAC,CAAC;CACH,OAAO,QAAO,CAAC;CAChB;AAEG,CAAJ,EAAI,CAAA,OAAO,EAAG,CAAA,KAAK,CAAC;AAClB,CAAA,IAAG,CAAE;AACH,CAAA,WAAQ,CAAE,aAAY;AACtB,CAAA,SAAM,CAAI,QAAO;AACjB,CAAA,UAAO,CAAG,OAAM;AAChB,CAAA,QAAK,CAAK;AACR,CAAA,aAAQ,CAAR,SAAQ;AACR,CAAA,SAAI,CAAI,UAAS;AACjB,CAAA,QAAG,CAAK,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,OAAM,CAAE,UAAS,CAAC;AAE/C,CAAA,uBAAkB,CAAE,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,qBAAoB,CAAC;AAE9D,CAAA,cAAS,CAAE,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,MAAK,CAAE,YAAW,CAAC;AACnD,CAAA,cAAS,CAAE,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,MAAK,CAAE,YAAW,CAAC;AACnD,CAAA,kBAAa,CAAE,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,MAAK,CAAE,kBAAiB,CAAC;AAC7D,CAAA,gBAAW,CAAE,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,MAAK,CAAE,cAAa,CAAC;AAEvD,CAAA,iBAAY,CAAG,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,MAAK,CAAE,eAAc,CAAC;AAC1D,CAAA,qBAAgB,CAAG,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,MAAK,CAAE,qBAAoB,CAAC;AACpE,CAAA,eAAU,CAAK,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,MAAK,CAAE,UAAS,CAAC;AACrD,CAAA,kBAAa,CAAE,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,MAAK,CAAE,eAAc,CAAC;AAE1D,CAAA,UAAK,CAAE,CAAA,OAAO,IAAI,eAAe;CAAA,IAClC;AACD,CAAA,aAAU,CAAE;AACV,CAAA,YAAO,CAAE,EAAC,OAAO,IAAI,UAAU,EAAG,QAAO,EAAG,OAAM,CAAC;AACnD,CAAA,SAAI,CAAE,CAAA,OAAO,IAAI,cAAc,GAAI,OAAM;CAAA,IAC1C;AACD,CAAA,SAAM,CAAI;AACR,CAAA,SAAI,CAAY,YAAW;AAC3B,CAAA,cAAS,CAAO,MAAK;AACrB,CAAA,eAAU,CAAM,MAAK;AACrB,CAAA,mBAAc,CAAE,aAAY;AAC5B,CAAA,kBAAa,CAAG,0BAAyB;CAAA,IAC1C;AACD,CAAA,QAAK,CAAE;AACL,CAAA,gBAAW,CAAE,YAAW;AACxB,CAAA,oBAAe,CAAE,MAAK;AACtB,CAAA,aAAQ,CAAR,SAAQ;AACR,CAAA,OAAE,CAAE;AACF,CAAA,SAAE,CAAW,MAAK;AAClB,CAAA,WAAI,CAAS,QAAO;AACpB,CAAA,WAAI,CAAS,SAAQ;AACrB,CAAA,eAAQ,CAAK,OAAM;AACnB,CAAA,gBAAS,CAAI,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,KAAI,CAAE,oBAAmB,CAAC;AAC5D,CAAA,gBAAS,CAAI,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,KAAI,CAAE,iBAAgB,CAAC;AACzD,CAAA,iBAAU,CAAG,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,KAAI,CAAE,oBAAmB,CAAC;AAC5D,CAAA,kBAAW,CAAE,qBAAoB;AACjC,CAAA,yBAAkB,CAAE,mCAAkC;CAAA,MACvD;CAAA,IACF;CAAA,EACF;AACD,CAAA,KAAI,CAAE;AACJ,CAAA,QAAK,CAAE,EACL,GAAG,CAAE,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,OAAM,CAAE,eAAc,CAAC,CAClD;AACD,CAAA,SAAM,CAAE;AACN,CAAA,cAAS,CAAK,WAAU;AACxB,CAAA,eAAU,CAAI,WAAU;AACxB,CAAA,gBAAW,CAAG,0BAAyB;CAAA,IACxC;AACD,CAAA,QAAK,CAAE,EACL,EAAE,CAAE,EACF,SAAS,CAAG,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,KAAI,CAAE,sBAAqB,CAAC,CAC9D,CACF;CAAA,EACF;CAAA,AACF,CAAC,CAAC;CAEH,OAAS,IAAG,CAAC,CAAE;CACb,OAAO,CAAA,OAAO,IAAI,SAAS,GAAI,aAAY,CAAC;CAC7C;AAEM,CAFN,OAEe,IAAG,CAAC,GAAG,CAAE;CACvB,KAAI,GAAG,GAAI,MAAK;CAAE,SAAO,CAAA,GAAG,EAAE,CAAC;AAE3B,CAF2B,IAE3B,CAAA,IAAI,EAAK,CAAA,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;AACxB,CAAJ,IAAI,CAAA,MAAM,EAAG,CAAA,OAAO,CAAC,GAAG,EAAE,CAAC,GAAI,CAAA,OAAO,CAAC,GAAG,CAAC,CAAC;CAE5C,MAAQ,GAAA,CAAA,CAAC,EAAG,EAAC,CAAE,CAAA,CAAC,EAAG,CAAA,IAAI,OAAO,CAAE,CAAA,CAAC,EAAE,CAAE;AACnC,CAAA,SAAM,EAAG,CAAA,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;CACzB,OAAI,CAAC,MAAM;CAAE,WAAM;CAAA,EACpB;AAED,CAFC,OAEM,OAAM,CAAC;CACf;AAAA,CAAA,AAAC;CAEK,OAAS,IAAG,CAAC,GAAG,CAAE,CAAA,KAAK;;;CAC5B,KAAI,GAAG,GAAI,MAAK,CAAE;AAChB,CAAA,UAAO,IAAI,SAAS,EAAG,MAAK,CAAC;GAC9B,KAAM;AACD,CAAJ,MAAI,CAAA,IAAI,EGxIZ,CAAA,eAAe,OAAO,EHwIJ,GAAG,EAAE,EAAK,CAAA,GAAG,MAAM,CAAC,GAAG,CAAC,CGxID,AHwIE,CAAC;AACpC,CAAJ,MAAI,CAAA,MAAM,0CAAM,CAAA,IAAI,IAAI,EAAE;YAAG,MAAK;;;;aAAE,CAAC;CACrC,UAAM,GAAG,EAAI,CAAA,IAAI,IAAI,EAAE,CAAE;AAAE,CAAA,WAAM,0CAAM,IAAG;cAAG,OAAM;;;;eAAE,CAAA;KAAE;AAAA,CAAA,IAAC;CAGxD,OAAI,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,CAAE;AACnB,CAAA,YAAO,CAAC,GAAG,EAAE,CAAC,EAAG,CAAA,CAAC,UAAU,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;KAC5C;AAED,CAFC,IAEA,MAAM,CAAC,OAAO,CAAE,OAAM,CAAC,CAAC;GAC1B;AACD,CADC,OACM,MAAK,CAAC;CACd;AIpJD,CAAA,KAAM,QAAQ;CCAd,UAAwB;CAAE,cAAyB;GAAE;CAArD,UAAwB;CAAE,cAAyB;GAAE;ACArD,CAAA,WAAU,CAAE,KAAI;CAAA,AFAkB,CAAC;CJqJnC","sourcesContent":["import { _ } from 'azk/utils';\nvar path    = require('path');\nvar dnsSync = require('dns-sync');\n\n// Root path\nvar azk_root =\n  process.env.AZK_ROOT_PATH ||\n  path.join('..', '..');\n\nvar data_path =\n  process.env.AZK_DATA_PATH ||\n  path.join(process.env.HOME, '.azk', 'data');\n\n// Use virtual machine\nvar requires_vm = (process.env.AZK_USE_VM == \"true\");\n\n// Vm informations\n// TODO: Show erro if not resolve ip\nvar vm_name = process.env.AZK_AGENT_VM_NAME || \"azk-agent\";\nvar vm_ip   = process.env.AZK_AGENT_VM_IP || dnsSync.resolve(vm_name);\n\n// Balancer configuration\nvar balancer = {\n    ip: process.env.AZK_BALANCER_IP   || vm_ip,\n  host: process.env.AZK_BALANCER_HOST,\n  port: process.env.AZK_BALANCER_PORT || 80,\n  file_dns: \"/etc/resolver/\" + process.env.AZK_BALANCER_HOST,\n};\n\n// Docker opts\nvar docker_host =\n  process.env.AZK_DOCKER_HOST ||\n  (requires_vm ? \"http://\" + vm_ip + \":4243\" : \"unix:///var/run/docker.sock\");\n\n// Log level\nvar log_level = process.env.AZK_DEBUG ? 'debug' : 'warn';\n\nfunction merge(options) {\n  _.each(options, (values, key) => {\n    if (key != '*')\n      options[key] = _.merge({}, options['*'], values);\n  });\n  return options;\n}\n\nvar options = merge({\n  '*': {\n    manifest: \"Azkfile.js\",\n    locale  : 'en-US',\n    azk_dir : \".azk\",\n    paths   : {\n      azk_root,\n      data  : data_path,\n      log   : path.join(data_path, 'logs', 'azk.log'),\n\n      persistent_folders: path.join(data_path, 'persistent_folders'),\n\n      agent_pid: path.join(data_path, 'run', 'agent.pid'),\n      unfsd_pid: path.join(data_path, 'run', 'unfsd.pid'),\n      memcached_pid: path.join(data_path, 'run', 'memcachedjs.pid'),\n      hipache_pid: path.join(data_path, 'run', 'hipache.pid'),\n\n      agent_socket : path.join(data_path, 'run', 'agent.socket'),\n      memcached_socket : path.join(data_path, 'run', 'memcachedjs.socket'),\n      unfsd_file   : path.join(data_path, 'run', 'exports'),\n      balancer_file: path.join(data_path, 'run', 'hipache.json'),\n\n      unfsd: process.env.AZK_UNFSD_PATH,\n    },\n    logs_level: {\n      console: (process.env.AZK_DEBUG ? 'debug' : 'warn'),\n      file: process.env.AZK_LOG_LEVEL || 'info',\n    },\n    docker  : {\n      host          : docker_host,\n      namespace     : 'azk',\n      repository    : 'azk',\n      default_domain: 'dev.azk.io',\n      image_default : 'azukiapp/busybox:latest',\n    },\n    agent: {\n      requires_vm: requires_vm,\n      portrange_start: 11000,\n      balancer,\n      vm: {\n        ip         : vm_ip,\n        name       : vm_name,\n        user       : \"docker\",\n        password   : \"live\",\n        boot_disk  : path.join(data_path, \"vm\", \"debian2docker.iso\"),\n        data_disk  : path.join(data_path, \"vm\", \"azk-agent.vmdk\"),\n        blank_disk : path.join(data_path, \"vm\", \"azk-agent.vmdk.bz\"),\n        mount_point: '/home/docker/files',\n        persistent_folders: '/mnt/sda1/azk/persistent_folders',\n      }\n    }\n  },\n  test: {\n    paths: {\n      log: path.join(data_path, 'logs', 'azk_test.log'),\n    },\n    docker: {\n      namespace   : 'azk.test',\n      repository  : 'azk-test',\n      image_empty : 'cevich/empty_base_image',\n    },\n    agent: {\n      vm: {\n        data_disk : path.join(data_path, \"vm\", \"azk-agent-spec.vmdk\"),\n      }\n    }\n  }\n});\n\nfunction env() {\n  return process.env.NODE_ENV || 'production';\n}\n\nexport function get(key) {\n  if (key == \"env\") return env();\n\n  var keys   = key.split(':');\n  var buffer = options[env()] || options['*'];\n\n  for(var i = 0; i < keys.length; i++) {\n    buffer = buffer[keys[i]];\n    if (!buffer) break;\n  }\n\n  return buffer;\n};\n\nexport function set(key, value) {\n  if (key == \"env\") {\n    process.env.NODE_ENV = value;\n  } else {\n    var keys   = [env(), ...key.split(':')];\n    var buffer = { [keys.pop()]: value };\n    while(key  = keys.pop()) { buffer = { [key]: buffer } };\n\n    // Check env exist\n    if (!options[env()]) {\n      options[env()] = _.cloneDeep(options['*']);\n    }\n\n    _.merge(options, buffer);\n  }\n  return value;\n}\n","var __moduleName = $__placeholder__0;","require($__placeholder__0)","$traceurRuntime.spread($__placeholder__0)","module.exports = $__placeholder__0;","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true"]}