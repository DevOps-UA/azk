{"version":3,"file":"rules.js","sources":["../../../src/generator/rules.js","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"AAAA;ACAI,CAAJ,EAAI,CAAA,YAAY,wBAAoB,CAAC;UCArC,CAAA,OAAO,CFAiB,KAAK,CEAH;;;AFCtB,CAAJ,EAAI,CAAA,IAAI,EAAG,CAAA,OAAO,CAAC,MAAM,CAAC,CAAC;AAEvB,CAAJ,EAAI,CAAA,cAAc,EAAG;AACnB,CAAA,KAAI,CAAM,UAAS;AACnB,CAAA,QAAO,CAAG,GAAE;AACZ,CAAA,MAAK,CAAK;AAAE,CAAA,aAAU,CAAE,eAAc;AAAE,CAAA,MAAG,CAAE,QAAO;CAAA,EAAE;AACtD,CAAA,QAAO,CAAG,2BAA0B;AACpC,CAAA,SAAQ,CAAE,KAAI;AACd,CAAA,QAAO,CAAG,uBAAsB;AAChC,CAAA,cAAa,CAAG,KAAI;AACpB,CAAA,mBAAkB,CAAE,GAAE;CAAA,AACvB,CAAC;AAEE,CAAJ,EAAI,CAAA,OAAO,EAAG;AACZ,CAAA,eAAc,CAAd,eAAc;CAEd,UAAS,CAAT,UAAU,GAAG,CAAE;CACb,SAAO,CAAA,IAAI,SAAS,CAAC,GAAG,CAAC,CAAC;GAC3B;CAED,iBAAgB,CAAhB,UAAiB,IAAI,CAAE,CAAA,UAAU,AAAc;OAAZ,QAAO,6CAAG,GAAE;;CAC7C,SAAO,CAAA,CAAC,OAAO,CAAC,IAAI,YAAG,OAAO,CAAE,CAAA,GAAG,CAAK;AAClC,CAAJ,QAAI,CAAA,MAAM,EAAG;AACX,CAAA,UAAG,CAAE,IAAG;AACR,CAAA,WAAI,CAAE,CAAA,cAAc,CAAC,GAAG,CAAC;CAAA,MAC1B,CAAC;CAEF,SAAI,GAAG,GAAI,CAAA,OAAO,KAAK,CAAE;AACnB,CAAJ,UAAI,CAAA,QAAQ,EAAG,CAAA,IAAI,SAAS,CAAC,OAAO,KAAK,CAAE,IAAG,CAAC,CAAC;AAChD,CAAA,aAAM,QAAQ,EAAG,CAAA,IAAI,KAAK,CAAC,UAAU,QAAQ,CAAE,SAAQ,CAAC,CAAC;OAC1D;AAED,CAFC,YAEM,CAAC,MAAM,KAAK,CAAC,EAAG,CAAA,CAAC,OAAO,CAAC,EAAE,CAAE,WAAU,CAAE,OAAM,CAAC,CAAC;CACxD,WAAO,QAAO,CAAC;KAChB,EAAE,GAAE,CAAC,CAAC;GACR;CAED,oBAAmB,CAAnB,UAAoB,GAAG,CAAE,CAAA,SAAS;AAC5B,CAAJ,MAAI,CAAA,QAAQ,EAAG,EACb,IAAI,KAAK,CAAC,GAAG,CAAE,UAAS,CAAC,CACzB,CAAA,IAAI,KAAK,CAAC,GAAG,CAAE,IAAG,CAAE,UAAS,CAAC,CAC/B,CAAA;AAEG,CAAJ,MAAI,CAAA,KAAK,EAAG,CAAA,CAAC,OAAO,CAAC,QAAQ,YAAG,KAAK,CAAE,CAAA,OAAO,CAAK;CACjD,WAAO,CAAA,KAAK,OAAO,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;KACzC,EAAE,GAAE,CAAC,CAAC;CAEP,SAAO,CAAA,CAAC,IAAI,CAAC,KAAK,YAAG,IAAI,CAAK;CAAE,WAAO,CAAA,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAA;KAAE,EAAC,CAAC;GAC9D;CACF,CAAA;;AGlDD,CAAA,KAAM,QAAQ;CCAd,cAAwB;CAAE,kBAAyB;GAAE;CAArD,qBAAwB;CAAE,yBAAyB;GAAE;ACArD,CAAA,WAAU,CAAE,KAAI;CAAA,AFAkB,CAAC;CHqDnC","sourcesContent":["import { path, _ } from 'azk';\nvar glob = require('glob');\n\nvar example_system = {\n  name    : \"example\",\n  depends : [],\n  image   : { repository: \"[repository]\", tag: \"[tag]\" },\n  workdir : \"/azk/<%= manifest.dir %>\",\n  balancer: true,\n  command : \"# command to run app\",\n  mount_folders : true,\n  persistent_folders: [],\n};\n\nvar Helpers = {\n  example_system,\n\n  nameByDir(dir) {\n    return path.basename(dir);\n  },\n\n  makeSystemByDirs(dirs, suggestion, options = {}) {\n    return _.reduce(dirs, (systems, dir) => {\n      var system = {\n        dir: dir,\n        name: this.nameByDir(dir),\n      };\n\n      if (dir != options.root) {\n        var relative = path.relative(options.root, dir);\n        system.workdir = path.join(suggestion.workdir, relative);\n      }\n\n      systems[system.name] = _.extend({}, suggestion, system);\n      return systems;\n    }, {});\n  },\n\n  searchSystemsByFile(dir, file_name) {\n    var patterns = [\n      path.join(dir, file_name),\n      path.join(dir, \"*\", file_name),\n    ]\n\n    var files = _.reduce(patterns, (files, pattern) => {\n      return files.concat(glob.sync(pattern));\n    }, []);\n\n    return _.map(files, (file) => { return path.dirname(file) });\n  },\n}\n\nexport { Helpers, example_system };\n","var __moduleName = $__placeholder__0;","require($__placeholder__0)","module.exports = $__placeholder__0;","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true"]}