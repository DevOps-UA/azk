{"version":3,"file":"option.js","sources":["../../../src/cli/option.js","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"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","sourcesContent":["import { _, t } from 'azk';\nimport { InvalidValueError } from 'azk/utils/errors';\n\nvar boolean_opts = ['1', '0', 'false', 'true', false, true];\n\nexport class Option {\n  constructor(opts) {\n    _.merge(this, {\n      show_default: true,\n    }, opts);\n\n    if (_.has(opts, 'default'))\n      this._default = opts.default;\n  }\n\n  get default() {\n    var value = this._default;\n\n    // Boolean with acc\n    if (this.type == Boolean && this.acc) {\n      value = value ? 1 : 0;\n    }\n\n    return _.has(this, '_default') ? value : (\n      this.type == Boolean ? false : null\n    )\n  }\n\n  set default(value) {\n    this._default = value;\n  }\n\n  haveDefault() {\n    return _.has(this, \"_default\");\n  }\n\n  set type(value) {\n    this._type = value;\n  }\n\n  get type() {\n    return this._type || (_.isArray(this.options) ? String : Boolean);\n  }\n\n  help(desc) {\n    var help = [];\n    // Names\n    var names = _.reduce(this.alias, (names, alias) => {\n      if (alias.length == 1) {\n        names.push('-' + alias);\n        if (this.acc) names.push('-' + alias + alias);\n      } else {\n        names.push('--' + alias);\n      }\n      return names;\n    }, []);\n\n    switch(this.type) {\n      case String:\n        names[0] += `=\"${this.default != null ? this.default : ''}\"`;\n        break;\n      case Boolean:\n        if (this.show_default)\n          var value = this.default;\n          if (value != null) {\n            desc += ` (default: ${value ? true : false})`;\n          }\n        break;\n    }\n\n    if (this.acc) {\n      desc += \" - multiples supported\"\n    }\n\n    return [names.join(', '), desc].join('\\t');\n  }\n\n  helpValues(tKey) {\n    var help = [];\n\n    _.each(this.options, (opt) => {\n      var desc = t(_.isObject(opt) ? [\"commands\", opt.name, \"description\"] : [...tKey, opt]);\n      help.push(this.__optionName(opt) + '\\t' + desc);\n    });\n\n    return help;\n  }\n\n  __optionName(opt) {\n    return _.isObject(opt) ? opt.name : opt\n  }\n\n  processValue(value) {\n    switch(this.type) {\n      case String:\n        if (_.isArray(this.options)) {\n          var options = _.map(this.options, this.__optionName);\n          if (!_.contains(options, value)) {\n            throw new InvalidValueError(this.name, value);\n          }\n        }\n        return value;\n      case Number:\n        return value.match(/^-?[\\d|.|,]*$/) ? Number(value) : null;\n      default:\n        if (!_.contains(boolean_opts, value))\n          throw new InvalidValueError(this.name, value);\n        return (value == \"true\" || value == 1) ? true : false;\n    }\n  }\n}\n","var __moduleName = $__placeholder__0;","require($__placeholder__0)","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2)","$traceurRuntime.spread($__placeholder__0)","module.exports = $__placeholder__0;","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true"]}