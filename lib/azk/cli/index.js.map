{"version":3,"file":"index.js","sources":["../../../src/cli/index.js","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/21","@traceur/generated/TemplateParser/24","@traceur/generated/TemplateParser/23","@traceur/generated/TemplateParser/22","@traceur/generated/TemplateParser/20","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"AAAA;ACAI,CAAJ,EAAI,CAAA,YAAY,kBAAoB,CAAC;UCArC,CAAA,OAAO,CFAsB,KAAK,CEAR;;;;;SAA1B,CAAA,OAAO,CFCa,aAAa,CEDP;QAA1B,CAAA,OAAO,CFEY,YAAY,CEFL;UAA1B,CAAA,OAAO,CFGqC,kBAAkB,CEHpC;;;AFKtB,CAAJ,EAAI,CAAA,IAAI,EAAG,CAAA,OAAO,CAAC,MAAM,CAAC,CAAC;AACvB,CAAJ,EAAI,CAAA,SAAS,EAAG,CAAA,IAAI,KAAK,CAAC,SAAS,CAAE,KAAI,CAAE,OAAM,CAAC,CAAC;AGN/C,CAAJ,EAAI,SHQJ,SAAM,OAAM;AIRZ,CAAA,gBAAe,iBAAiB,CAAC,IAAI,CACrB,kBAA2B,CAAE,UAAS,CAAC,CAAA;CDDd,AHgCxC,CGhCwC;AEArC,CAAJ,EAAI,iBAAqC,CAAA;ACAzC,CAAA,AAAC,eAAe,YAAY,CAAC;CNS3B,WAAU,CAAV,UAAW,KAAK,CAAE;AAChB,CAAA,OAAI,KAAK,CAAC,oBAAoB,CAAE,CAAA,KAAK,MAAM,CAAC,CAAC;AAC7C,CAAA,OAAI,UAAU,EAAE,CAAC;CACjB,SAAO,CAAA,CAAC,CAAC,CAAC,CAAC,CAAC;GACb;CAED,OAAM,CAAN,UAAO,IAAI,CAAE,CAAA,WAAW,CAAE;CACxB,OAAI,IAAI,QAAQ,CAAE;AAChB,CAAA,SAAI,QAAQ,EAAG,UAAS,CAAA;KACzB;AAED,CAFC,OAEG,IAAI,KAAK,GAAI,EAAC,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC,CAAA,EAAI,CAAA,CAAC,QAAQ,CAAC,IAAI,WAAW,CAAC,CAAC,CAAE;AACxE,CAAA,SAAI,UAAU,EAAE,CAAC;CACjB,WAAO,CAAA,CAAC,CAAC,CAAC,CAAC,CAAC;KACb;AAGD,CAHC,OAGG,IAAI,IAAI,CAAE;AACZ,CAAA,QAAG,gBAAgB,CAAC,IAAI,IAAI,CAAC,CAAC;KAC/B;AAED,CAFC,SO5BL,CAAA,eAAe,UAAU,qCP8BR,IAAI,CAAE,YAAW,EO7BmB,CP6BjB;GACjC;CAAA,KAvBkB,IAAG,CMPiC;CNiClD,OAAS,IAAG,CAAC,IAAI,CAAE,CAAA,GAAG,AAAS;KAAP,GAAE,6CAAG,GAAE;CACpC,IAAI;AACE,CAAJ,MAAI,CAAA,OAAO,EAAG,IAAI,OAAM,CAAC,KAAK,CAAE,GAAE,CAAE,UAAS,CAAC,CAAC;AAC/C,CAAA,UAAO,UAAU,CAAC,CAAC,WAAW,CAAE,KAAI,CAAC,CAAE;AAAE,CAAA,YAAO,CAAE,MAAK;AAAE,CAAA,iBAAY,CAAE,MAAK;CAAA,IAAE,CAAC,CAAC;AAChF,CAAA,UAAO,UAAU,CAAC,CAAC,OAAO,CAAE,KAAI,CAAC,CAAG,EAAE,IAAI,CAAE,OAAM,CAAC,CAAC,CAAC;AACrD,CAAA,UAAO,UAAU,CAAC,CAAC,QAAQ,CAAE,KAAI,CAAC,CAAE,EAAE,YAAY,CAAE,MAAK,CAAE,CAAE,CAAA;AAC7D,CAAA,UAAO,YAAY,CAAC,CAAC,CAAC,uBAAuB,CAAC,CAAC,CAAA;AAE/C,CAAA,UAAO,IAAI,EAAG,IAAG,CAAC;AACd,CAAJ,MAAI,CAAA,MAAM,EAAG,CAAA,OAAO,IAAI,CAAC,CAAC,KAAK,CAAC,IAAI,CAAE,EAAC,CAAC,CAAC,CAAC;GAC3C,CAAC,OAAO,CAAC,CAAE;AACN,CAAJ,MAAI,CAAA,MAAM,EAAG,CAAA,CAAC,CAAC,WAAY,kBAAiB,CAAA,EAAI,CAAA,CAAC,OAAO,GAAI,UAAS,CAAC,EACpE,CAAA,OAAO,WAAW,CAAC,CAAC,CAAC,CAAA,CAAG,CAAA,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;GACvC;AAED,CAFC,KAEG,CAAC,UAAU,CAAC,MAAM,CAAC,CAAE;AACvB,CAAA,SAAM,KAAK,WAAE,IAAI,CAAK;AACpB,CAAA,OAAE,KAAK,CAAC,IAAI,EAAG,KAAI,EAAG,EAAC,CAAC,CAAC;KAC1B,aAAG,KAAK,CAAK;CACZ,SAAI,KAAK,WAAY,SAAQ,CAAE;AAC7B,CAAA,SAAE,KAAK,CAAC,KAAK,SAAS,EAAE,CAAC,CAAC;OAC3B,KAAM;AACL,CAAA,SAAE,KAAK,CAAC,KAAK,MAAM,EAAG,CAAA,KAAK,MAAM,EAAG,MAAK,CAAC,CAAC;OAC5C;AACD,CADC,OACC,KAAK,CAAC,KAAK,KAAK,EAAG,CAAA,KAAK,KAAK,EAAG,IAAG,CAAC,CAAC;KACxC,EAAC,CAAC;GACJ;CAAA,AACF;AQ7DD,CAAA,KAAM,QAAQ;CCAd,UAAwB;CAAE,cAAyB;GAAE;ACArD,CAAA,WAAU,CAAE,KAAI;CAAA,AFAkB,CAAC;CR8DnC","sourcesContent":["import { _, Q, log, t } from 'azk';\nimport { Cli } from 'azk/cli/cli';\nimport { UI } from 'azk/cli/ui';\nimport { InvalidValueError, AzkError } from 'azk/utils/errors';\n\nvar path = require('path');\nvar cmds_path = path.join(__dirname, \"..\", \"cmds\");\n\nclass CmdCli extends Cli {\n  invalidCmd(error) {\n    this.fail(\"commands.not_found\", error.value);\n    this.showUsage();\n    return Q(1);\n  }\n\n  action(opts, parent_opts) {\n    if (opts.version) {\n      opts.command = \"version\"\n    }\n\n    if (opts.help || (_.isEmpty(opts.command) && _.isEmpty(opts.__leftover))) {\n      this.showUsage();\n      return Q(0);\n    }\n\n    // Set log level\n    if (opts.log) {\n      log.setConsoleLevel(opts.log);\n    }\n\n    return super(opts, parent_opts);\n  }\n}\n\nexport function cli(args, cwd, ui = UI) {\n  try {\n    var azk_cli = new CmdCli('azk', ui, cmds_path);\n    azk_cli.addOption(['--version', '-v'], { default: false, show_default: false });\n    azk_cli.addOption(['--log', '-l'] , { type: String});\n    azk_cli.addOption(['--help', '-h'], { show_default: false } )\n    azk_cli.addExamples(t(\"commands.azk.examples\"))\n\n    azk_cli.cwd = cwd;\n    var result = azk_cli.run(_.rest(args, 2));\n  } catch (e) {\n    var result = (e instanceof InvalidValueError && e.option == \"command\") ?\n      azk_cli.invalidCmd(e) : Q.reject(e);\n  }\n\n  if (Q.isPromise(result)) {\n    result.then((code) => {\n      ui.exit(code ? code : 0);\n    }, (error) => {\n      if (error instanceof AzkError) {\n        ui.fail(error.toString());\n      } else {\n        ui.fail(error.stack ? error.stack : error);\n      }\n      ui.exit(error.code ? error.code : 127);\n    });\n  }\n}\n","var __moduleName = $__placeholder__0;","require($__placeholder__0)","var $__placeholder__0 = $__placeholder__1","$traceurRuntime.defaultSuperCall(this,\n                $__placeholder__0.prototype, arguments)","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2,\n                                       $__placeholder__3)","$traceurRuntime.superCall($__placeholder__0, $__placeholder__1, $__placeholder__2,\n                                   $__placeholder__3)","module.exports = $__placeholder__0;","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true"]}