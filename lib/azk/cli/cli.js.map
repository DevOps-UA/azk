{"version":3,"file":"cli.js","sources":["../../../src/cli/cli.js","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"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","sourcesContent":["import { _ } from 'azk';\nimport { sync as glob } from 'glob';\nimport { Command, Option } from 'azk/cli/command';\nimport { InvalidValueError } from 'azk/utils/errors';\n\nvar path = require('path');\n\nexport { Command };\nexport class Cli extends Command {\n  constructor(name, user_interface, cmds_cwd) {\n    super(name, user_interface, cmds_cwd);\n\n    // Load sub-commands\n    if (cmds_cwd) {\n      this.__load_cmds(cmds_cwd);\n    }\n  }\n\n  initChildren(children) {\n    this.addCmd(children);\n  }\n\n  __load_cmds(cwd) {\n    var cmds = glob(\"*.js\", { cwd: cwd });\n    _.each(cmds, (cmd) => {\n      require(path.join(cwd, cmd)).init(this);\n    });\n  }\n\n  // External options\n  addCmd(cmd) {\n    var opt = _.find(this.stackable, (opt) => { return opt.name == 'command' });\n    if (!opt) {\n      opt = new Option({\n        name: 'command', type: String, require: true, options: [], stop: true\n      });\n      this.stackable.push(opt);\n    }\n    opt.options.push(cmd);\n    this.commands[cmd.name] = cmd;\n  }\n\n  showUsage(command = null) {\n    if (!command) return super();\n\n    var cmd = this.commands[command];\n    if (!cmd)\n      throw new InvalidValueError('command', command);\n\n    // Show usage for command\n    var prefix = this.usageLine(\"command\");\n    return cmd.showUsage(prefix);\n  }\n\n  action(opts, parent_opts) {\n    var cmd = this.commands[opts.command];\n    if (cmd && cmd instanceof Command) {\n      return cmd.run(_.clone(opts.__leftover), opts);\n    }\n  }\n}\n\n","var __moduleName = $__placeholder__0;","require($__placeholder__0)","var $__placeholder__0 = $__placeholder__1","$traceurRuntime.superCall($__placeholder__0, $__placeholder__1, $__placeholder__2,\n                                   $__placeholder__3)","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2,\n                                       $__placeholder__3)","module.exports = $__placeholder__0;","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true"]}